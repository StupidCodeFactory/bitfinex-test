FROM node:18-bullseye


ARG DHT_PORT=20001
ENV DHT_PORT ${DHT_PORT}

ARG API_PORT=30001
ENV API_PORT ${API_PORT}

ARG BOOTSTRAP_NODES=127.0.0.1:20002,127.0.0.1:20003
ENV BOOTSTRAP_NODES ${BOOTSTRAP_NODES}

RUN npm install -g npm@latest grenache-grape

EXPOSE ${DHT_PORT}
EXPOSE ${API_PORT}

CMD DEBUG=* grape -b 0.0.0.0 --dp $DHT_PORT --dc 32 --aph $API_PORT --bn $BOOTSTRAP_NODES
